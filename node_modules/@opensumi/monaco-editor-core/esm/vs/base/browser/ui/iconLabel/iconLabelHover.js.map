{"version":3,"sources":["vs/base/browser/ui/iconLabel/iconLabelHover.ts"],"names":[],"mappings":"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","file":"iconLabelHover.js","sourceRoot":"file:///workspaces/monaco-editor-core/out-editor-esm","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as dom from '../../dom';\nimport { HoverPosition } from '../hover/hoverWidget';\nimport { IHoverDelegate, IHoverDelegateOptions, IHoverDelegateTarget, IHoverWidget } from './iconHoverDelegate';\nimport { TimeoutTimer } from '../../../common/async';\nimport { CancellationToken, CancellationTokenSource } from '../../../common/cancellation';\nimport { IMarkdownString, isMarkdownString } from '../../../common/htmlContent';\nimport { stripIcons } from '../../../common/iconLabels';\nimport { DisposableStore, IDisposable } from '../../../common/lifecycle';\nimport { isFunction, isString } from '../../../common/types';\nimport { localize } from '../../../../nls';\n\nexport interface ITooltipMarkdownString {\n\tmarkdown: IMarkdownString | string | undefined | ((token: CancellationToken) => Promise<IMarkdownString | string | undefined>);\n\tmarkdownNotSupportedFallback: string | undefined;\n}\n\nexport function setupNativeHover(htmlElement: HTMLElement, tooltip: string | ITooltipMarkdownString | undefined): void {\n\tif (isString(tooltip)) {\n\t\t// Icons don't render in the native hover so we strip them out\n\t\thtmlElement.title = stripIcons(tooltip);\n\t} else if (tooltip?.markdownNotSupportedFallback) {\n\t\thtmlElement.title = tooltip.markdownNotSupportedFallback;\n\t} else {\n\t\thtmlElement.removeAttribute('title');\n\t}\n}\n\ntype IHoverContent = string | ITooltipMarkdownString | HTMLElement | undefined;\ntype IHoverContentOrFactory = IHoverContent | (() => IHoverContent);\ntype IResolvedHoverContent = IMarkdownString | string | HTMLElement | undefined;\n\n/**\n * Copied from src\\vs\\workbench\\services\\hover\\browser\\hover.ts\n * @deprecated Use IHoverService\n */\ninterface IHoverAction {\n\tlabel: string;\n\tcommandId: string;\n\ticonClass?: string;\n\trun(target: HTMLElement): void;\n}\n\nexport interface IUpdatableHoverOptions {\n\tactions?: IHoverAction[];\n\tlinkHandler?(url: string): void;\n}\n\nexport interface ICustomHover extends IDisposable {\n\n\t/**\n\t * Allows to programmatically open the hover.\n\t */\n\tshow(focus?: boolean): void;\n\n\t/**\n\t * Allows to programmatically hide the hover.\n\t */\n\thide(): void;\n\n\t/**\n\t * Updates the contents of the hover.\n\t */\n\tupdate(tooltip: IHoverContent, options?: IUpdatableHoverOptions): void;\n}\n\n\nclass UpdatableHoverWidget implements IDisposable {\n\n\tprivate _hoverWidget: IHoverWidget | undefined;\n\tprivate _cancellationTokenSource: CancellationTokenSource | undefined;\n\n\tconstructor(private hoverDelegate: IHoverDelegate, private target: IHoverDelegateTarget | HTMLElement, private fadeInAnimation: boolean) {\n\t}\n\n\tasync update(content: IHoverContent, focus?: boolean, options?: IUpdatableHoverOptions): Promise<void> {\n\t\tif (this._cancellationTokenSource) {\n\t\t\t// there's an computation ongoing, cancel it\n\t\t\tthis._cancellationTokenSource.dispose(true);\n\t\t\tthis._cancellationTokenSource = undefined;\n\t\t}\n\t\tif (this.isDisposed) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet resolvedContent;\n\t\tif (content === undefined || isString(content) || content instanceof HTMLElement) {\n\t\t\tresolvedContent = content;\n\t\t} else if (!isFunction(content.markdown)) {\n\t\t\tresolvedContent = content.markdown ?? content.markdownNotSupportedFallback;\n\t\t} else {\n\t\t\t// compute the content, potentially long-running\n\n\t\t\t// show 'Loading' if no hover is up yet\n\t\t\tif (!this._hoverWidget) {\n\t\t\t\tthis.show(localize('iconLabel.loading', \"Loading...\"), focus);\n\t\t\t}\n\n\t\t\t// compute the content\n\t\t\tthis._cancellationTokenSource = new CancellationTokenSource();\n\t\t\tconst token = this._cancellationTokenSource.token;\n\t\t\tresolvedContent = await content.markdown(token);\n\t\t\tif (resolvedContent === undefined) {\n\t\t\t\tresolvedContent = content.markdownNotSupportedFallback;\n\t\t\t}\n\n\t\t\tif (this.isDisposed || token.isCancellationRequested) {\n\t\t\t\t// either the widget has been closed in the meantime\n\t\t\t\t// or there has been a new call to `update`\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tthis.show(resolvedContent, focus, options);\n\t}\n\n\tprivate show(content: IResolvedHoverContent, focus?: boolean, options?: IUpdatableHoverOptions): void {\n\t\tconst oldHoverWidget = this._hoverWidget;\n\n\t\tif (this.hasContent(content)) {\n\t\t\tconst hoverOptions: IHoverDelegateOptions = {\n\t\t\t\tcontent,\n\t\t\t\ttarget: this.target,\n\t\t\t\tappearance: {\n\t\t\t\t\tshowPointer: this.hoverDelegate.placement === 'element',\n\t\t\t\t\tskipFadeInAnimation: !this.fadeInAnimation || !!oldHoverWidget, // do not fade in if the hover is already showing\n\t\t\t\t},\n\t\t\t\tposition: {\n\t\t\t\t\thoverPosition: HoverPosition.BELOW,\n\t\t\t\t},\n\t\t\t\t...options\n\t\t\t};\n\n\t\t\tthis._hoverWidget = this.hoverDelegate.showHover(hoverOptions, focus);\n\t\t}\n\t\toldHoverWidget?.dispose();\n\t}\n\n\tprivate hasContent(content: IResolvedHoverContent): content is NonNullable<IResolvedHoverContent> {\n\t\tif (!content) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (isMarkdownString(content)) {\n\t\t\treturn !!content.value;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tget isDisposed() {\n\t\treturn this._hoverWidget?.isDisposed;\n\t}\n\n\tdispose(): void {\n\t\tthis._hoverWidget?.dispose();\n\t\tthis._cancellationTokenSource?.dispose(true);\n\t\tthis._cancellationTokenSource = undefined;\n\t}\n}\n\nexport function setupCustomHover(hoverDelegate: IHoverDelegate, htmlElement: HTMLElement, content: IHoverContentOrFactory, options?: IUpdatableHoverOptions): ICustomHover {\n\tlet hoverPreparation: IDisposable | undefined;\n\n\tlet hoverWidget: UpdatableHoverWidget | undefined;\n\n\tconst hideHover = (disposeWidget: boolean, disposePreparation: boolean) => {\n\t\tconst hadHover = hoverWidget !== undefined;\n\t\tif (disposeWidget) {\n\t\t\thoverWidget?.dispose();\n\t\t\thoverWidget = undefined;\n\t\t}\n\t\tif (disposePreparation) {\n\t\t\thoverPreparation?.dispose();\n\t\t\thoverPreparation = undefined;\n\t\t}\n\t\tif (hadHover) {\n\t\t\thoverDelegate.onDidHideHover?.();\n\t\t\thoverWidget = undefined;\n\t\t}\n\t};\n\n\tconst triggerShowHover = (delay: number, focus?: boolean, target?: IHoverDelegateTarget) => {\n\t\treturn new TimeoutTimer(async () => {\n\t\t\tif (!hoverWidget || hoverWidget.isDisposed) {\n\t\t\t\thoverWidget = new UpdatableHoverWidget(hoverDelegate, target || htmlElement, delay > 0);\n\t\t\t\tawait hoverWidget.update(typeof content === 'function' ? content() : content, focus, options);\n\t\t\t}\n\t\t}, delay);\n\t};\n\n\tlet isMouseDown = false;\n\tconst mouseDownEmitter = dom.addDisposableListener(htmlElement, dom.EventType.MOUSE_DOWN, () => {\n\t\tisMouseDown = true;\n\t\thideHover(true, true);\n\t}, true);\n\tconst mouseUpEmitter = dom.addDisposableListener(htmlElement, dom.EventType.MOUSE_UP, () => {\n\t\tisMouseDown = false;\n\t}, true);\n\tconst mouseLeaveEmitter = dom.addDisposableListener(htmlElement, dom.EventType.MOUSE_LEAVE, (e: MouseEvent) => {\n\t\tisMouseDown = false;\n\t\thideHover(false, (<any>e).fromElement === htmlElement);\n\t}, true);\n\n\tconst onMouseOver = () => {\n\t\tif (hoverPreparation) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst toDispose: DisposableStore = new DisposableStore();\n\n\t\tconst target: IHoverDelegateTarget = {\n\t\t\ttargetElements: [htmlElement],\n\t\t\tdispose: () => { }\n\t\t};\n\t\tif (hoverDelegate.placement === undefined || hoverDelegate.placement === 'mouse') {\n\t\t\t// track the mouse position\n\t\t\tconst onMouseMove = (e: MouseEvent) => {\n\t\t\t\ttarget.x = e.x + 10;\n\t\t\t\tif ((e.target instanceof HTMLElement) && e.target.classList.contains('action-label')) {\n\t\t\t\t\thideHover(true, true);\n\t\t\t\t}\n\t\t\t};\n\t\t\ttoDispose.add(dom.addDisposableListener(htmlElement, dom.EventType.MOUSE_MOVE, onMouseMove, true));\n\t\t}\n\t\ttoDispose.add(triggerShowHover(hoverDelegate.delay, false, target));\n\n\t\thoverPreparation = toDispose;\n\t};\n\tconst mouseOverDomEmitter = dom.addDisposableListener(htmlElement, dom.EventType.MOUSE_OVER, onMouseOver, true);\n\n\tconst onFocus = () => {\n\t\tif (isMouseDown || hoverPreparation) {\n\t\t\treturn;\n\t\t}\n\t\tconst target: IHoverDelegateTarget = {\n\t\t\ttargetElements: [htmlElement],\n\t\t\tdispose: () => { }\n\t\t};\n\t\tconst toDispose: DisposableStore = new DisposableStore();\n\t\tconst onBlur = () => hideHover(true, true);\n\t\ttoDispose.add(dom.addDisposableListener(htmlElement, dom.EventType.BLUR, onBlur, true));\n\t\ttoDispose.add(triggerShowHover(hoverDelegate.delay, false, target));\n\t\thoverPreparation = toDispose;\n\t};\n\tconst focusDomEmitter = dom.addDisposableListener(htmlElement, dom.EventType.FOCUS, onFocus, true);\n\tconst hover: ICustomHover = {\n\t\tshow: focus => {\n\t\t\thideHover(false, true); // terminate a ongoing mouse over preparation\n\t\t\ttriggerShowHover(0, focus); // show hover immediately\n\t\t},\n\t\thide: () => {\n\t\t\thideHover(true, true);\n\t\t},\n\t\tupdate: async (newContent, hoverOptions) => {\n\t\t\tcontent = newContent;\n\t\t\tawait hoverWidget?.update(content, undefined, hoverOptions);\n\t\t},\n\t\tdispose: () => {\n\t\t\tmouseOverDomEmitter.dispose();\n\t\t\tmouseLeaveEmitter.dispose();\n\t\t\tmouseDownEmitter.dispose();\n\t\t\tmouseUpEmitter.dispose();\n\t\t\tfocusDomEmitter.dispose();\n\t\t\thideHover(true, true);\n\t\t}\n\t};\n\treturn hover;\n}\n"]}
{"version":3,"sources":["vs/editor/contrib/inlayHints/browser/inlayHintsHover.ts"],"names":[],"mappings":"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","file":"inlayHintsHover.js","sourceRoot":"file:///workspaces/monaco-editor-core/out-editor-esm","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { AsyncIterableObject } from '../../../../base/common/async';\nimport { CancellationToken } from '../../../../base/common/cancellation';\nimport { IMarkdownString, isEmptyMarkdownString, MarkdownString } from '../../../../base/common/htmlContent';\nimport { ICodeEditor, IEditorMouseEvent, MouseTargetType } from '../../../browser/editorBrowser';\nimport { Position } from '../../../common/core/position';\nimport { IModelDecoration } from '../../../common/model';\nimport { ModelDecorationInjectedTextOptions } from '../../../common/model/textModel';\nimport { HoverAnchor, HoverForeignElementAnchor, IEditorHoverParticipant } from '../../hover/browser/hoverTypes';\nimport { ILanguageService } from '../../../common/languages/language';\nimport { ITextModelService } from '../../../common/services/resolverService';\nimport { getHover } from '../../hover/browser/getHover';\nimport { MarkdownHover, MarkdownHoverParticipant } from '../../hover/browser/markdownHoverParticipant';\nimport { RenderedInlayHintLabelPart, InlayHintsController } from './inlayHintsController';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration';\nimport { IOpenerService } from '../../../../platform/opener/common/opener';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures';\nimport { EditorOption } from '../../../common/config/editorOptions';\nimport { localize } from '../../../../nls';\nimport * as platform from '../../../../base/common/platform';\nimport { asCommandLink } from './inlayHints';\nimport { isNonEmptyArray } from '../../../../base/common/arrays';\n\nclass InlayHintsHoverAnchor extends HoverForeignElementAnchor {\n\tconstructor(\n\t\treadonly part: RenderedInlayHintLabelPart,\n\t\towner: InlayHintsHover,\n\t\tinitialMousePosX: number | undefined,\n\t\tinitialMousePosY: number | undefined\n\t) {\n\t\tsuper(10, owner, part.item.anchor.range, initialMousePosX, initialMousePosY, true);\n\t}\n}\n\nexport class InlayHintsHover extends MarkdownHoverParticipant implements IEditorHoverParticipant<MarkdownHover> {\n\n\tpublic override readonly hoverOrdinal: number = 6;\n\n\tconstructor(\n\t\teditor: ICodeEditor,\n\t\t@ILanguageService languageService: ILanguageService,\n\t\t@IOpenerService openerService: IOpenerService,\n\t\t@IConfigurationService configurationService: IConfigurationService,\n\t\t@ITextModelService private readonly _resolverService: ITextModelService,\n\t\t@ILanguageFeaturesService languageFeaturesService: ILanguageFeaturesService,\n\t) {\n\t\tsuper(editor, languageService, openerService, configurationService, languageFeaturesService);\n\t}\n\n\tsuggestHoverAnchor(mouseEvent: IEditorMouseEvent): HoverAnchor | null {\n\t\tconst controller = InlayHintsController.get(this._editor);\n\t\tif (!controller) {\n\t\t\treturn null;\n\t\t}\n\t\tif (mouseEvent.target.type !== MouseTargetType.CONTENT_TEXT) {\n\t\t\treturn null;\n\t\t}\n\t\tconst options = mouseEvent.target.detail.injectedText?.options;\n\t\tif (!(options instanceof ModelDecorationInjectedTextOptions && options.attachedData instanceof RenderedInlayHintLabelPart)) {\n\t\t\treturn null;\n\t\t}\n\t\treturn new InlayHintsHoverAnchor(options.attachedData, this, mouseEvent.event.posx, mouseEvent.event.posy);\n\t}\n\n\toverride computeSync(): MarkdownHover[] {\n\t\treturn [];\n\t}\n\n\toverride computeAsync(anchor: HoverAnchor, _lineDecorations: IModelDecoration[], token: CancellationToken): AsyncIterableObject<MarkdownHover> {\n\t\tif (!(anchor instanceof InlayHintsHoverAnchor)) {\n\t\t\treturn AsyncIterableObject.EMPTY;\n\t\t}\n\n\t\treturn new AsyncIterableObject<MarkdownHover>(async executor => {\n\n\t\t\tconst { part } = anchor;\n\t\t\tawait part.item.resolve(token);\n\n\t\t\tif (token.isCancellationRequested) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// (1) Inlay Tooltip\n\t\t\tlet itemTooltip: IMarkdownString | undefined;\n\t\t\tif (typeof part.item.hint.tooltip === 'string') {\n\t\t\t\titemTooltip = new MarkdownString().appendText(part.item.hint.tooltip);\n\t\t\t} else if (part.item.hint.tooltip) {\n\t\t\t\titemTooltip = part.item.hint.tooltip;\n\t\t\t}\n\t\t\tif (itemTooltip) {\n\t\t\t\texecutor.emitOne(new MarkdownHover(this, anchor.range, [itemTooltip], false, 0));\n\t\t\t}\n\t\t\t// (1.2) Inlay dbl-click gesture\n\t\t\tif (isNonEmptyArray(part.item.hint.textEdits)) {\n\t\t\t\texecutor.emitOne(new MarkdownHover(this, anchor.range, [new MarkdownString().appendText(localize('hint.dbl', \"Double-click to insert\"))], false, 10001));\n\t\t\t}\n\n\t\t\t// (2) Inlay Label Part Tooltip\n\t\t\tlet partTooltip: IMarkdownString | undefined;\n\t\t\tif (typeof part.part.tooltip === 'string') {\n\t\t\t\tpartTooltip = new MarkdownString().appendText(part.part.tooltip);\n\t\t\t} else if (part.part.tooltip) {\n\t\t\t\tpartTooltip = part.part.tooltip;\n\t\t\t}\n\t\t\tif (partTooltip) {\n\t\t\t\texecutor.emitOne(new MarkdownHover(this, anchor.range, [partTooltip], false, 1));\n\t\t\t}\n\n\t\t\t// (2.2) Inlay Label Part Help Hover\n\t\t\tif (part.part.location || part.part.command) {\n\t\t\t\tlet linkHint: MarkdownString | undefined;\n\t\t\t\tconst useMetaKey = this._editor.getOption(EditorOption.multiCursorModifier) === 'altKey';\n\t\t\t\tconst kb = useMetaKey\n\t\t\t\t\t? platform.isMacintosh\n\t\t\t\t\t\t? localize('links.navigate.kb.meta.mac', \"cmd + click\")\n\t\t\t\t\t\t: localize('links.navigate.kb.meta', \"ctrl + click\")\n\t\t\t\t\t: platform.isMacintosh\n\t\t\t\t\t\t? localize('links.navigate.kb.alt.mac', \"option + click\")\n\t\t\t\t\t\t: localize('links.navigate.kb.alt', \"alt + click\");\n\n\t\t\t\tif (part.part.location && part.part.command) {\n\t\t\t\t\tlinkHint = new MarkdownString().appendText(localize('hint.defAndCommand', 'Go to Definition ({0}), right click for more', kb));\n\t\t\t\t} else if (part.part.location) {\n\t\t\t\t\tlinkHint = new MarkdownString().appendText(localize('hint.def', 'Go to Definition ({0})', kb));\n\t\t\t\t} else if (part.part.command) {\n\t\t\t\t\tlinkHint = new MarkdownString(`[${localize('hint.cmd', \"Execute Command\")}](${asCommandLink(part.part.command)} \"${part.part.command.title}\") (${kb})`, { isTrusted: true });\n\t\t\t\t}\n\t\t\t\tif (linkHint) {\n\t\t\t\t\texecutor.emitOne(new MarkdownHover(this, anchor.range, [linkHint], false, 10000));\n\t\t\t\t}\n\t\t\t}\n\n\n\t\t\t// (3) Inlay Label Part Location tooltip\n\t\t\tconst iterable = await this._resolveInlayHintLabelPartHover(part, token);\n\t\t\tfor await (const item of iterable) {\n\t\t\t\texecutor.emitOne(item);\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate async _resolveInlayHintLabelPartHover(part: RenderedInlayHintLabelPart, token: CancellationToken): Promise<AsyncIterableObject<MarkdownHover>> {\n\t\tif (!part.part.location) {\n\t\t\treturn AsyncIterableObject.EMPTY;\n\t\t}\n\t\tconst { uri, range } = part.part.location;\n\t\tconst ref = await this._resolverService.createModelReference(uri);\n\t\ttry {\n\t\t\tconst model = ref.object.textEditorModel;\n\t\t\tif (!this._languageFeaturesService.hoverProvider.has(model)) {\n\t\t\t\treturn AsyncIterableObject.EMPTY;\n\t\t\t}\n\t\t\treturn getHover(this._languageFeaturesService.hoverProvider, model, new Position(range.startLineNumber, range.startColumn), token)\n\t\t\t\t.filter(item => !isEmptyMarkdownString(item.hover.contents))\n\t\t\t\t.map(item => new MarkdownHover(this, part.item.anchor.range, item.hover.contents, false, 2 + item.ordinal));\n\t\t} finally {\n\t\t\tref.dispose();\n\t\t}\n\t}\n}\n"]}
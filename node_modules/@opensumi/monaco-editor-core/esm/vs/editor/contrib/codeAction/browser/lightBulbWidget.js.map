{"version":3,"sources":["vs/editor/contrib/codeAction/browser/lightBulbWidget.ts"],"names":[],"mappings":"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","file":"lightBulbWidget.js","sourceRoot":"file:///workspaces/monaco-editor-core/out-editor-esm","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as dom from '../../../../base/browser/dom';\nimport { Gesture } from '../../../../base/browser/touch';\nimport { Codicon } from '../../../../base/common/codicons';\nimport { Emitter, Event } from '../../../../base/common/event';\nimport { Disposable } from '../../../../base/common/lifecycle';\nimport { ThemeIcon } from '../../../../base/common/themables';\nimport './lightBulbWidget.css';\nimport { ContentWidgetPositionPreference, ICodeEditor, IContentWidget, IContentWidgetPosition } from '../../../browser/editorBrowser';\nimport { EditorOption } from '../../../common/config/editorOptions';\nimport { IPosition } from '../../../common/core/position';\nimport { computeIndentLevel } from '../../../common/model/utils';\nimport { autoFixCommandId, quickFixCommandId } from './codeAction';\nimport type { CodeActionSet, CodeActionTrigger } from '../common/types';\nimport * as nls from '../../../../nls';\nimport { ICommandService } from '../../../../platform/commands/common/commands';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding';\n\nexport namespace LightBulbState {\n\n\texport const enum Type {\n\t\tHidden,\n\t\tShowing,\n\t}\n\n\texport const Hidden = { type: Type.Hidden } as const;\n\n\texport class Showing {\n\t\treadonly type = Type.Showing;\n\n\t\tconstructor(\n\t\t\tpublic readonly actions: CodeActionSet,\n\t\t\tpublic readonly trigger: CodeActionTrigger,\n\t\t\tpublic readonly editorPosition: IPosition,\n\t\t\tpublic readonly widgetPosition: IContentWidgetPosition,\n\t\t) { }\n\t}\n\n\texport type State = typeof Hidden | Showing;\n}\n\nexport class LightBulbWidget extends Disposable implements IContentWidget {\n\n\tpublic static readonly ID = 'editor.contrib.lightbulbWidget';\n\n\tprotected static readonly _posPref = [ContentWidgetPositionPreference.EXACT];\n\n\tprotected readonly _domNode: HTMLElement;\n\n\tprotected readonly _onClick = this._register(new Emitter<{ readonly x: number; readonly y: number; readonly actions: CodeActionSet; readonly trigger: CodeActionTrigger }>());\n\tpublic readonly onClick = this._onClick.event;\n\n\tprotected _state: LightBulbState.State = LightBulbState.Hidden;\n\tprotected _iconClasses: string[] = [];\n\n\tprotected _preferredKbLabel?: string;\n\tprotected _quickFixKbLabel?: string;\n\n\tconstructor(\n\t\tprotected readonly _editor: ICodeEditor,\n\t\t@IKeybindingService protected readonly _keybindingService: IKeybindingService,\n\t\t@ICommandService commandService: ICommandService,\n\t) {\n\t\tsuper();\n\n\t\tthis._domNode = dom.$('div.lightBulbWidget');\n\n\t\tthis._register(Gesture.ignoreTarget(this._domNode));\n\n\t\tthis._editor.addContentWidget(this);\n\n\t\tthis._register(this._editor.onDidChangeModelContent(_ => {\n\t\t\t// cancel when the line in question has been removed\n\t\t\tconst editorModel = this._editor.getModel();\n\t\t\tif (this.state.type !== LightBulbState.Type.Showing || !editorModel || this.state.editorPosition.lineNumber >= editorModel.getLineCount()) {\n\t\t\t\tthis.hide();\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(dom.addStandardDisposableGenericMouseDownListener(this._domNode, e => {\n\t\t\tif (this.state.type !== LightBulbState.Type.Showing) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Make sure that focus / cursor location is not lost when clicking widget icon\n\t\t\tthis._editor.focus();\n\t\t\te.preventDefault();\n\n\t\t\t// a bit of extra work to make sure the menu\n\t\t\t// doesn't cover the line-text\n\t\t\tconst { top, height } = dom.getDomNodePagePosition(this._domNode);\n\t\t\tconst lineHeight = this._editor.getOption(EditorOption.lineHeight);\n\n\t\t\tlet pad = Math.floor(lineHeight / 3);\n\t\t\tif (this.state.widgetPosition.position !== null && this.state.widgetPosition.position.lineNumber < this.state.editorPosition.lineNumber) {\n\t\t\t\tpad += lineHeight;\n\t\t\t}\n\n\t\t\tthis._onClick.fire({\n\t\t\t\tx: e.posx,\n\t\t\t\ty: top + height + pad,\n\t\t\t\tactions: this.state.actions,\n\t\t\t\ttrigger: this.state.trigger,\n\t\t\t});\n\t\t}));\n\n\t\tthis._register(dom.addDisposableListener(this._domNode, 'mouseenter', (e: MouseEvent) => {\n\t\t\tif ((e.buttons & 1) !== 1) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// mouse enters lightbulb while the primary/left button\n\t\t\t// is being pressed -> hide the lightbulb\n\t\t\tthis.hide();\n\t\t}));\n\n\n\t\tthis._register(Event.runAndSubscribe(this._keybindingService.onDidUpdateKeybindings, () => {\n\t\t\tthis._preferredKbLabel = this._keybindingService.lookupKeybinding(autoFixCommandId)?.getLabel() ?? undefined;\n\t\t\tthis._quickFixKbLabel = this._keybindingService.lookupKeybinding(quickFixCommandId)?.getLabel() ?? undefined;\n\n\t\t\tthis._updateLightBulbTitleAndIcon();\n\t\t}));\n\t}\n\n\toverride dispose(): void {\n\t\tsuper.dispose();\n\t\tthis._editor.removeContentWidget(this);\n\t}\n\n\tgetId(): string {\n\t\treturn 'LightBulbWidget';\n\t}\n\n\tgetDomNode(): HTMLElement {\n\t\treturn this._domNode;\n\t}\n\n\tgetPosition(): IContentWidgetPosition | null {\n\t\treturn this._state.type === LightBulbState.Type.Showing ? this._state.widgetPosition : null;\n\t}\n\n\tpublic update(actions: CodeActionSet, trigger: CodeActionTrigger, atPosition: IPosition) {\n\t\tif (actions.validActions.length <= 0) {\n\t\t\treturn this.hide();\n\t\t}\n\n\t\tconst options = this._editor.getOptions();\n\t\tif (!options.get(EditorOption.lightbulb).enabled) {\n\t\t\treturn this.hide();\n\t\t}\n\n\n\t\tconst model = this._editor.getModel();\n\t\tif (!model) {\n\t\t\treturn this.hide();\n\t\t}\n\n\t\tconst { lineNumber, column } = model.validatePosition(atPosition);\n\n\t\tconst tabSize = model.getOptions().tabSize;\n\t\tconst fontInfo = this._editor.getOptions().get(EditorOption.fontInfo);\n\t\tconst lineContent = model.getLineContent(lineNumber);\n\t\tconst indent = computeIndentLevel(lineContent, tabSize);\n\t\tconst lineHasSpace = fontInfo.spaceWidth * indent > 22;\n\t\tconst isFolded = (lineNumber: number) => {\n\t\t\treturn lineNumber > 2 && this._editor.getTopForLineNumber(lineNumber) === this._editor.getTopForLineNumber(lineNumber - 1);\n\t\t};\n\n\t\tlet effectiveLineNumber = lineNumber;\n\t\tlet effectiveColumnNumber = 1;\n\t\tif (!lineHasSpace) {\n\t\t\tif (lineNumber > 1 && !isFolded(lineNumber - 1)) {\n\t\t\t\teffectiveLineNumber -= 1;\n\t\t\t} else if ((lineNumber < model.getLineCount()) && !isFolded(lineNumber + 1)) {\n\t\t\t\teffectiveLineNumber += 1;\n\t\t\t} else if (column * fontInfo.spaceWidth < 22) {\n\t\t\t\t// cannot show lightbulb above/below and showing\n\t\t\t\t// it inline would overlay the cursor...\n\t\t\t\treturn this.hide();\n\t\t\t}\n\t\t\teffectiveColumnNumber = /^\\S\\s*$/.test(model.getLineContent(effectiveLineNumber)) ? 2 : 1;\n\t\t}\n\n\t\tthis.state = new LightBulbState.Showing(actions, trigger, atPosition, {\n\t\t\tposition: { lineNumber: effectiveLineNumber, column: effectiveColumnNumber },\n\t\t\tpreference: LightBulbWidget._posPref\n\t\t});\n\t\tthis._editor.layoutContentWidget(this);\n\t}\n\n\tpublic hide(): void {\n\t\tif (this.state === LightBulbState.Hidden) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.state = LightBulbState.Hidden;\n\t\tthis._editor.layoutContentWidget(this);\n\t}\n\n\tprotected get state(): LightBulbState.State { return this._state; }\n\n\tprotected set state(value) {\n\t\tthis._state = value;\n\t\tthis._updateLightBulbTitleAndIcon();\n\t}\n\n\tprotected _updateLightBulbTitleAndIcon(): void {\n\t\tthis._domNode.classList.remove(...this._iconClasses);\n\t\tthis._iconClasses = [];\n\t\tif (this.state.type !== LightBulbState.Type.Showing) {\n\t\t\treturn;\n\t\t}\n\t\tlet icon: ThemeIcon;\n\t\tlet autoRun = false;\n\t\tif (this.state.actions.allAIFixes) {\n\t\t\ticon = Codicon.sparkleFilled;\n\t\t\tif (this.state.actions.validActions.length === 1) {\n\t\t\t\tautoRun = true;\n\t\t\t}\n\t\t} else if (this.state.actions.hasAutoFix) {\n\t\t\tif (this.state.actions.hasAIFix) {\n\t\t\t\ticon = Codicon.lightbulbSparkleAutofix;\n\t\t\t} else {\n\t\t\t\ticon = Codicon.lightbulbAutofix;\n\t\t\t}\n\t\t} else if (this.state.actions.hasAIFix) {\n\t\t\ticon = Codicon.lightbulbSparkle;\n\t\t} else {\n\t\t\ticon = Codicon.lightBulb;\n\t\t}\n\t\tthis._updateLightbulbTitle(this.state.actions.hasAutoFix, autoRun);\n\t\tthis._iconClasses = ThemeIcon.asClassNameArray(icon);\n\t\tthis._domNode.classList.add(...this._iconClasses);\n\t}\n\n\tprotected _updateLightbulbTitle(autoFix: boolean, autoRun: boolean): void {\n\t\tif (this.state.type !== LightBulbState.Type.Showing) {\n\t\t\treturn;\n\t\t}\n\t\tif (autoRun) {\n\t\t\tthis.title = nls.localize('codeActionAutoRun', \"Run: {0}\", this.state.actions.validActions[0].action.title);\n\t\t} else if (autoFix && this._preferredKbLabel) {\n\t\t\tthis.title = nls.localize('preferredcodeActionWithKb', \"Show Code Actions. Preferred Quick Fix Available ({0})\", this._preferredKbLabel);\n\t\t} else if (!autoFix && this._quickFixKbLabel) {\n\t\t\tthis.title = nls.localize('codeActionWithKb', \"Show Code Actions ({0})\", this._quickFixKbLabel);\n\t\t} else if (!autoFix) {\n\t\t\tthis.title = nls.localize('codeAction', \"Show Code Actions\");\n\t\t}\n\t}\n\n\tprotected set title(value: string) {\n\t\tthis._domNode.title = value;\n\t}\n}\n"]}
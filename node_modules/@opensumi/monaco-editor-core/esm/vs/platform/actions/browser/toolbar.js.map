{"version":3,"sources":["vs/platform/actions/browser/toolbar.ts"],"names":[],"mappings":"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","file":"toolbar.js","sourceRoot":"file:///workspaces/monaco-editor-core/out-editor-esm","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { addDisposableListener, getWindow } from '../../../base/browser/dom';\nimport { StandardMouseEvent } from '../../../base/browser/mouseEvent';\nimport { IToolBarOptions, ToolBar } from '../../../base/browser/ui/toolbar/toolbar';\nimport { IAction, Separator, SubmenuAction, toAction, WorkbenchActionExecutedClassification, WorkbenchActionExecutedEvent } from '../../../base/common/actions';\nimport { coalesceInPlace } from '../../../base/common/arrays';\nimport { intersection } from '../../../base/common/collections';\nimport { BugIndicatingError } from '../../../base/common/errors';\nimport { Emitter, Event } from '../../../base/common/event';\nimport { Iterable } from '../../../base/common/iterator';\nimport { DisposableStore } from '../../../base/common/lifecycle';\nimport { localize } from '../../../nls';\nimport { createAndFillInActionBarActions } from './menuEntryActionViewItem';\nimport { IMenuActionOptions, IMenuService, MenuId, MenuItemAction, SubmenuItemAction } from '../common/actions';\nimport { IContextKeyService } from '../../contextkey/common/contextkey';\nimport { IContextMenuService } from '../../contextview/browser/contextView';\nimport { IKeybindingService } from '../../keybinding/common/keybinding';\nimport { ITelemetryService } from '../../telemetry/common/telemetry';\n\nexport const enum HiddenItemStrategy {\n\t/** This toolbar doesn't support hiding*/\n\tNoHide = -1,\n\t/** Hidden items aren't shown anywhere */\n\tIgnore = 0,\n\t/** Hidden items move into the secondary group */\n\tRenderInSecondaryGroup = 1,\n}\n\nexport type IWorkbenchToolBarOptions = IToolBarOptions & {\n\n\t/**\n\t * Items of the primary group can be hidden. When this happens the item can\n\t * - move into the secondary popup-menu, or\n\t * - not be shown at all\n\t */\n\thiddenItemStrategy?: HiddenItemStrategy;\n\n\t/**\n\t * Optional menu id which is used for a \"Reset Menu\" command. This should be the\n\t * menu id that defines the contents of this workbench menu\n\t */\n\tresetMenu?: MenuId;\n\n\t/**\n\t * Optional menu id which items are used for the context menu of the toolbar.\n\t */\n\tcontextMenu?: MenuId;\n\n\t/**\n\t * Optional options how menu actions are created and invoked\n\t */\n\tmenuOptions?: IMenuActionOptions;\n\n\t/**\n\t * When set the `workbenchActionExecuted` is automatically send for each invoked action. The `from` property\n\t * of the event will the passed `telemetrySource`-value\n\t */\n\ttelemetrySource?: string;\n\n\t/** This is controlled by the WorkbenchToolBar */\n\tallowContextMenu?: never;\n\n\t/**\n\t * Controls the overflow behavior of the primary group of toolbar. This isthe maximum number of items and id of\n\t * items that should never overflow\n\t *\n\t */\n\toverflowBehavior?: { maxItems: number; exempted?: string[] };\n};\n\n/**\n * The `WorkbenchToolBar` does\n * - support hiding of menu items\n * - lookup keybindings for each actions automatically\n * - send `workbenchActionExecuted`-events for each action\n *\n * See {@link MenuWorkbenchToolBar} for a toolbar that is backed by a menu.\n */\nexport class WorkbenchToolBar extends ToolBar {\n\n\tprivate readonly _sessionDisposables = this._store.add(new DisposableStore());\n\n\tconstructor(\n\t\tcontainer: HTMLElement,\n\t\tprivate _options: IWorkbenchToolBarOptions | undefined,\n\t\t@IMenuService private readonly _menuService: IMenuService,\n\t\t@IContextKeyService private readonly _contextKeyService: IContextKeyService,\n\t\t@IContextMenuService private readonly _contextMenuService: IContextMenuService,\n\t\t@IKeybindingService keybindingService: IKeybindingService,\n\t\t@ITelemetryService telemetryService: ITelemetryService,\n\t) {\n\t\tsuper(container, _contextMenuService, {\n\t\t\t// defaults\n\t\t\tgetKeyBinding: (action) => keybindingService.lookupKeybinding(action.id) ?? undefined,\n\t\t\t// options (override defaults)\n\t\t\t..._options,\n\t\t\t// mandatory (overide options)\n\t\t\tallowContextMenu: true,\n\t\t\tskipTelemetry: typeof _options?.telemetrySource === 'string',\n\t\t});\n\n\t\t// telemetry logic\n\t\tconst telemetrySource = _options?.telemetrySource;\n\t\tif (telemetrySource) {\n\t\t\tthis._store.add(this.actionBar.onDidRun(e => telemetryService.publicLog2<WorkbenchActionExecutedEvent, WorkbenchActionExecutedClassification>(\n\t\t\t\t'workbenchActionExecuted',\n\t\t\t\t{ id: e.action.id, from: telemetrySource })\n\t\t\t));\n\t\t}\n\t}\n\n\toverride setActions(_primary: readonly IAction[], _secondary: readonly IAction[] = [], menuIds?: readonly MenuId[]): void {\n\n\t\tthis._sessionDisposables.clear();\n\t\tconst primary: Array<IAction | undefined> = _primary.slice(); // for hiding and overflow we set some items to undefined\n\t\tconst secondary = _secondary.slice();\n\t\tconst toggleActions: IAction[] = [];\n\t\tlet toggleActionsCheckedCount: number = 0;\n\n\t\tconst extraSecondary: Array<IAction | undefined> = [];\n\n\t\tlet someAreHidden = false;\n\t\t// unless disabled, move all hidden items to secondary group or ignore them\n\t\tif (this._options?.hiddenItemStrategy !== HiddenItemStrategy.NoHide) {\n\t\t\tfor (let i = 0; i < primary.length; i++) {\n\t\t\t\tconst action = primary[i];\n\t\t\t\tif (!(action instanceof MenuItemAction) && !(action instanceof SubmenuItemAction)) {\n\t\t\t\t\t// console.warn(`Action ${action.id}/${action.label} is not a MenuItemAction`);\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif (!action.hideActions) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\t// collect all toggle actions\n\t\t\t\ttoggleActions.push(action.hideActions.toggle);\n\t\t\t\tif (action.hideActions.toggle.checked) {\n\t\t\t\t\ttoggleActionsCheckedCount++;\n\t\t\t\t}\n\n\t\t\t\t// hidden items move into overflow or ignore\n\t\t\t\tif (action.hideActions.isHidden) {\n\t\t\t\t\tsomeAreHidden = true;\n\t\t\t\t\tprimary[i] = undefined;\n\t\t\t\t\tif (this._options?.hiddenItemStrategy !== HiddenItemStrategy.Ignore) {\n\t\t\t\t\t\textraSecondary[i] = action;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// count for max\n\t\tif (this._options?.overflowBehavior !== undefined) {\n\n\t\t\tconst exemptedIds = intersection(new Set(this._options.overflowBehavior.exempted), Iterable.map(primary, a => a?.id));\n\t\t\tconst maxItems = this._options.overflowBehavior.maxItems - exemptedIds.size;\n\n\t\t\tlet count = 0;\n\t\t\tfor (let i = 0; i < primary.length; i++) {\n\t\t\t\tconst action = primary[i];\n\t\t\t\tif (!action) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tcount++;\n\t\t\t\tif (exemptedIds.has(action.id)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif (count >= maxItems) {\n\t\t\t\t\tprimary[i] = undefined;\n\t\t\t\t\textraSecondary[i] = action;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// coalesce turns Array<IAction|undefined> into IAction[]\n\t\tcoalesceInPlace(primary);\n\t\tcoalesceInPlace(extraSecondary);\n\t\tsuper.setActions(primary, Separator.join(extraSecondary, secondary));\n\n\t\t// add context menu for toggle actions\n\t\tif (toggleActions.length > 0) {\n\t\t\tthis._sessionDisposables.add(addDisposableListener(this.getElement(), 'contextmenu', e => {\n\t\t\t\tconst event = new StandardMouseEvent(getWindow(this.getElement()), e);\n\n\t\t\t\tconst action = this.getItemAction(event.target);\n\t\t\t\tif (!(action)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tevent.preventDefault();\n\t\t\t\tevent.stopPropagation();\n\n\t\t\t\tlet noHide = false;\n\n\t\t\t\t// last item cannot be hidden when using ignore strategy\n\t\t\t\tif (toggleActionsCheckedCount === 1 && this._options?.hiddenItemStrategy === HiddenItemStrategy.Ignore) {\n\t\t\t\t\tnoHide = true;\n\t\t\t\t\tfor (let i = 0; i < toggleActions.length; i++) {\n\t\t\t\t\t\tif (toggleActions[i].checked) {\n\t\t\t\t\t\t\ttoggleActions[i] = toAction({\n\t\t\t\t\t\t\t\tid: action.id,\n\t\t\t\t\t\t\t\tlabel: action.label,\n\t\t\t\t\t\t\t\tchecked: true,\n\t\t\t\t\t\t\t\tenabled: false,\n\t\t\t\t\t\t\t\trun() { }\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tbreak; // there is only one\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// add \"hide foo\" actions\n\t\t\t\tlet hideAction: IAction;\n\t\t\t\tif (!noHide && (action instanceof MenuItemAction || action instanceof SubmenuItemAction)) {\n\t\t\t\t\tif (!action.hideActions) {\n\t\t\t\t\t\t// no context menu for MenuItemAction instances that support no hiding\n\t\t\t\t\t\t// those are fake actions and need to be cleaned up\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\thideAction = action.hideActions.hide;\n\n\t\t\t\t} else {\n\t\t\t\t\thideAction = toAction({\n\t\t\t\t\t\tid: 'label',\n\t\t\t\t\t\tlabel: localize('hide', \"Hide\"),\n\t\t\t\t\t\tenabled: false,\n\t\t\t\t\t\trun() { }\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tconst actions = Separator.join([hideAction], toggleActions);\n\n\t\t\t\t// add \"Reset Menu\" action\n\t\t\t\tif (this._options?.resetMenu && !menuIds) {\n\t\t\t\t\tmenuIds = [this._options.resetMenu];\n\t\t\t\t}\n\t\t\t\tif (someAreHidden && menuIds) {\n\t\t\t\t\tactions.push(new Separator());\n\t\t\t\t\tactions.push(toAction({\n\t\t\t\t\t\tid: 'resetThisMenu',\n\t\t\t\t\t\tlabel: localize('resetThisMenu', \"Reset Menu\"),\n\t\t\t\t\t\trun: () => this._menuService.resetHiddenStates(menuIds)\n\t\t\t\t\t}));\n\t\t\t\t}\n\n\t\t\t\tthis._contextMenuService.showContextMenu({\n\t\t\t\t\tgetAnchor: () => event,\n\t\t\t\t\tgetActions: () => actions,\n\t\t\t\t\t// add context menu actions (iff appicable)\n\t\t\t\t\tmenuId: this._options?.contextMenu,\n\t\t\t\t\tmenuActionOptions: { renderShortTitle: true, ...this._options?.menuOptions },\n\t\t\t\t\tskipTelemetry: typeof this._options?.telemetrySource === 'string',\n\t\t\t\t\tcontextKeyService: this._contextKeyService,\n\t\t\t\t});\n\t\t\t}));\n\t\t}\n\t}\n}\n\n// ---- MenuWorkbenchToolBar -------------------------------------------------\n\n\nexport interface IToolBarRenderOptions {\n\t/**\n\t * Determines what groups are considered primary. Defaults to `navigation`. Items of the primary\n\t * group are rendered with buttons and the rest is rendered in the secondary popup-menu.\n\t */\n\tprimaryGroup?: string | ((actionGroup: string) => boolean);\n\n\t/**\n\t * Inlinse submenus with just a single item\n\t */\n\tshouldInlineSubmenu?: (action: SubmenuAction, group: string, groupSize: number) => boolean;\n\n\t/**\n\t * Should the primary group allow for separators.\n\t */\n\tuseSeparatorsInPrimaryActions?: boolean;\n}\n\nexport interface IMenuWorkbenchToolBarOptions extends IWorkbenchToolBarOptions {\n\n\t/**\n\t * Optional options to configure how the toolbar renderes items.\n\t */\n\ttoolbarOptions?: IToolBarRenderOptions;\n\n\t/**\n\t * Only `undefined` to disable the reset command is allowed, otherwise the menus\n\t * id is used.\n\t */\n\tresetMenu?: undefined;\n}\n\n/**\n * A {@link WorkbenchToolBar workbench toolbar} that is purely driven from a {@link MenuId menu}-identifier.\n *\n * *Note* that Manual updates via `setActions` are NOT supported.\n */\nexport class MenuWorkbenchToolBar extends WorkbenchToolBar {\n\n\tprivate readonly _onDidChangeMenuItems = this._store.add(new Emitter<this>());\n\treadonly onDidChangeMenuItems: Event<this> = this._onDidChangeMenuItems.event;\n\n\tconstructor(\n\t\tcontainer: HTMLElement,\n\t\tmenuId: MenuId,\n\t\toptions: IMenuWorkbenchToolBarOptions | undefined,\n\t\t@IMenuService menuService: IMenuService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@IContextMenuService contextMenuService: IContextMenuService,\n\t\t@IKeybindingService keybindingService: IKeybindingService,\n\t\t@ITelemetryService telemetryService: ITelemetryService,\n\t) {\n\t\tsuper(container, { resetMenu: menuId, ...options }, menuService, contextKeyService, contextMenuService, keybindingService, telemetryService);\n\n\t\t// update logic\n\t\tconst menu = this._store.add(menuService.createMenu(menuId, contextKeyService, { emitEventsForSubmenuChanges: true }));\n\t\tconst updateToolbar = () => {\n\t\t\tconst primary: IAction[] = [];\n\t\t\tconst secondary: IAction[] = [];\n\t\t\tcreateAndFillInActionBarActions(\n\t\t\t\tmenu,\n\t\t\t\toptions?.menuOptions,\n\t\t\t\t{ primary, secondary },\n\t\t\t\toptions?.toolbarOptions?.primaryGroup, options?.toolbarOptions?.shouldInlineSubmenu, options?.toolbarOptions?.useSeparatorsInPrimaryActions\n\t\t\t);\n\t\t\tcontainer.classList.toggle('has-no-actions', primary.length === 0 && secondary.length === 0);\n\t\t\tsuper.setActions(primary, secondary);\n\t\t};\n\n\t\tthis._store.add(menu.onDidChange(() => {\n\t\t\tupdateToolbar();\n\t\t\tthis._onDidChangeMenuItems.fire(this);\n\t\t}));\n\t\tupdateToolbar();\n\t}\n\n\t/**\n\t * @deprecated The WorkbenchToolBar does not support this method because it works with menus.\n\t */\n\toverride setActions(): void {\n\t\tthrow new BugIndicatingError('This toolbar is populated from a menu.');\n\t}\n}\n"]}